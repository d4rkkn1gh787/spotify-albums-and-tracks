Pseudo-Code:

https://docs.google.com/document/d/1Gdgp_o8beLBB-SZfzFtQlcopyGD52wrmkb5aNUITzn0/edit?ts=57c872e8
